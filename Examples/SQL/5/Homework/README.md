# Урок 5. SQL – оконные функции


## Задача №1

> Создайте представление, в которое попадут автомобили:
> - стоимостью до 25 000 долларов
>

### Решение

```SQL
CREATE VIEW v_Cars_low_cost
AS
SELECT
    *
FROM
    Cars
WHERE
    cost < 25000
;
```

**Output:**
|id |name      |cost |
|---|----------|-----|
|3  |Skoda     |9000 |
|6  |Citroen   |21000|
|8  |Volkswagen|21600|



## Задача №2

> Изменить в существующем представлении порог для стоимости: 
> - пусть цена будет до 30 000 долларов (используя оператор ALTER VIEW)
> 

### Решение

К сожалению, в SQLite отсутствует конструкция ALTER VIEW,  единственный доступный
способ изменить представление – это сочетание `DROP VIEW` + `CREATE VIEW`
```SQL
DROP VIEW v_Cars_low_cost
;

CREATE VIEW v_Cars_low_cost
AS
SELECT
    *
FROM
    Cars
WHERE
    cost < 30000
;
```

**Output:**
|id |name      |cost |
|---|----------|-----|
|3  |Skoda     |9000 |
|4  |Volvo     |29000|
|6  |Citroen   |21000|
|8  |Volkswagen|21600|



## Задача №3

> Создайте представление, в котором будут только автомобили:
> - марки “Шкода” и “Ауди” (аналогично)
> 

### Решение

```SQL
CREATE VIEW v_Cars_skoda_and_audi
AS
SELECT
    *
FROM
    Cars
WHERE
    name IN ('Skoda', 'Audi')
;
```

**Output:**
|id |name |cost |
|---|-----|-----|
|1  |Audi |52642|
|3  |Skoda|9000 |



## Задача №4

> Вывести название и цену для всех анализов, которые:
> - продавались 5 февраля 2020 и всю следующую неделю.
> 
> Есть таблица анализов Analysis:
> - an_id — ID анализа;
> - an_name — название анализа;
> - an_cost — себестоимость анализа;
> - an_price — розничная цена анализа;
> - an_group — группа анализов.
> 
> Есть таблица групп анализов Groups:
> - gr_id — ID группы;
> - gr_name — название группы;
> - gr_temp — температурный режим хранения.
> 
> Есть таблица заказов Orders:
> - ord_id — ID заказа;
> - ord_datetime — дата и время заказа;
> - ord_an — ID анализа.
> 

### Решение

Очень много вопросов к задаче:
- Откуда брать данные для заполнения таблиц?
- Если нужно вывесть название и цену анализов за период времени, 
то зачем нам таблица Groups?
- ...

Семинаристом не даны ответы по выполнению задачи, методические
материалы семинара не обновлены.

```SQL

```

**Output:**
